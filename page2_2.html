<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>天赋自测 - 发现你的潜能</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #e9f2f9;
            --accent-color: #ff7e5f;
            --light-color: #ffffff;
            --dark-color: #333333;
            --border-color: #dde2e7;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            --radius: 12px;
        }
        
        body {
            background-color: #f8fafc;
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            background-image: linear-gradient(135deg, #f5f7fa 0%, #e9f2f9 100%);
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--light-color);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            min-height: 500px;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }
        
        .content {
            padding: 40px 30px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        /* 进度条 */
        .progress-container {
            margin-bottom: 30px;
        }
        
        .progress-bar {
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--accent-color);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
        }
        
        /* 问题容器 */
        .question-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .question-number {
            color: var(--primary-color);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.5rem;
            line-height: 1.4;
            margin-bottom: 40px;
            color: var(--dark-color);
        }
        
        /* 选项样式 */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .option-btn {
            padding: 18px 20px;
            border: 2px solid var(--border-color);
            background-color: white;
            border-radius: var(--radius);
            font-size: 1.1rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .option-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .option-btn.selected {
            border-color: var(--primary-color);
            background-color: var(--secondary-color);
            font-weight: 600;
        }
        
        .option-btn .option-label {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #eef5fc;
            color: var(--primary-color);
            font-weight: 600;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .option-btn.selected .option-label {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* 导航按钮 */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .nav-btn {
            padding: 14px 30px;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        #prevBtn {
            background-color: #f0f0f0;
            color: #666;
        }
        
        #prevBtn:hover:not(:disabled) {
            background-color: #e0e0e0;
        }
        
        #nextBtn {
            background-color: var(--primary-color);
            color: white;
        }
        
        #nextBtn:hover:not(:disabled) {
            background-color: #3a5a8c;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* 结果页面 */
        .result-container {
            text-align: center;
            padding: 30px;
        }
        
        .result-header {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 20px;
        }
        
        .result-score {
            font-size: 2rem;
            color: var(--accent-color);
            font-weight: 700;
            margin: 20px 0;
        }
        
        .result-description {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 20px;
            color: #555;
        }
        
        /* 雷达图容器 */
        .radar-container {
            margin: 30px auto;
            max-width: 600px;
            position: relative;
        }
        
        .radar-chart {
            width: 100%;
            height: 400px;
            position: relative;
        }
        
        canvas {
            display: block;
            margin: 0 auto;
        }
        
        /* 天赋分值表格 */
        .scores-table {
            width: 100%;
            max-width: 700px;
            margin: 30px auto;
            border-collapse: collapse;
        }
        
        .scores-table h3 {
            text-align: left;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .score-category {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .score-category:last-child {
            border-bottom: none;
        }
        
        .category-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-label {
            font-weight: bold;
            color: var(--primary-color);
            min-width: 40px;
        }
        
        .category-name {
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .score-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-color);
            min-width: 60px;
            text-align: right;
        }
        
        .score-level {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 15px;
        }
        
        .level-high {
            background-color: rgba(76, 175, 80, 0.15);
            color: #4caf50;
        }
        
        .level-medium {
            background-color: rgba(255, 193, 7, 0.15);
            color: #ff9800;
        }
        
        .level-low {
            background-color: rgba(244, 67, 54, 0.15);
            color: #f44336;
        }
        
        .radar-labels {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .radar-label {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
        }
        
        .radar-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }
        
        .score-details {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            font-size: 0.9rem;
        }
        
        .score-item {
            background-color: #f5f9ff;
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #e1e8f5;
        }
        
        .restart-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            background-color: #ff6b4a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 126, 95, 0.3);
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .content {
                padding: 25px 20px;
            }
            
            .question-text {
                font-size: 1.3rem;
            }
            
            .option-btn {
                padding: 16px 18px;
                font-size: 1rem;
            }
            
            .nav-btn {
                padding: 12px 25px;
            }
            
            .radar-chart {
                height: 320px;
            }
            
            .score-category {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .score-level {
                margin-left: auto;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .options-container {
                gap: 10px;
            }
            
            .option-btn {
                padding: 14px 16px;
            }
            
            .navigation {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
            
            .radar-chart {
                height: 280px;
            }
            
            .score-category {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .score-level {
                margin-left: 0;
                align-self: flex-end;
            }
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question-container {
            animation: fadeIn 0.5s ease;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 网站标题 -->
        <div class="header">
            <h1>天赋自测</h1>
            <p>本测试来自《唯自己成长的事，还是喜欢你？》</p>
        </div>
        
        <!-- 主要内容区域 -->
        <div class="content">
            <!-- 进度条 -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text">
                    <span id="currentQuestion">第 1 题</span>
                    <span id="totalQuestions">共 40 题</span>
                </div>
            </div>
            
            <!-- 问题容器（默认显示） -->
            <div class="question-container" id="questionContainer">
                <div class="question-number" id="questionNumber">问题 1/40</div>
                <div class="question-text" id="questionText">我擅长用艺术性的方式做事？</div>
                
                <!-- 选项容器 -->
                <div class="options-container" id="optionsContainer">
                    <!-- 选项将通过JS动态生成 -->
                </div>
                
                <!-- 导航按钮 -->
                <div class="navigation">
                    <button id="prevBtn" class="nav-btn" disabled>上一题</button>
                    <button id="nextBtn" class="nav-btn">下一题</button>
                </div>
            </div>
            
            <!-- 结果容器（初始隐藏） -->
            <div class="result-container hidden" id="resultContainer">
                <h2 class="result-header">测试完成！</h2>
                <p>你的测试结果如下：</p>
                
                <div class="result-score" id="resultScore">0 分</div>
                
                <div class="result-description" id="resultDescription">
                    根据你的选择，你倾向于...
                </div>
                
                <!-- 雷达图容器 -->
                <div class="radar-container">
                    <div class="radar-chart">
                        <canvas id="radarChart" width="500" height="400"></canvas>
                    </div>
                    <div class="radar-labels" id="radarLabels"></div>
                </div>
                
                <!-- 天赋分值表格 -->
                <div class="scores-table" id="scoresTable">
                    <h3>各项天赋分值</h3>
                    <!-- 分值将通过JS动态生成 -->
                </div>
                
                <button class="restart-btn" id="restartBtn">重新开始测试</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            { id: 1, text: "我喜欢用艺术性的方法做事？", category: "美学天赋" },
            { id: 2, text: "我乐于给别人传授知识？", category: "人际天赋" },
            { id: 3, text: "我擅长需要手眼协调的任务？", category: "身体-动觉天赋" },
            { id: 4, text: "我能流畅准确地完成一系列动作？", category: "身体-动觉天赋" },
            { id: 5, text: "我喜欢跟随音乐的节拍？", category: "音乐天赋" },
            { id: 6, text: "我能判断动物的需求？", category: "自然天赋" },
            { id: 7, text: "我擅长刻画塑造事物？", category: "美学天赋" },
            { id: 8, text: "我擅长需要手指灵巧的任务？", category: "身体-动觉天赋" },
            { id: 9, text: "我能清楚明白地阐述事情？", category: "语言天赋" },
            { id: 10, text: "我擅长让配色协调？", category: "美学天赋" },
            { id: 11, text: "我擅长理解公式？", category: "逻辑-算术天赋" },
            { id: 12, text: "我擅长与身体相关的任务？", category: "身体-动觉天赋" },
            { id: 13, text: "我能产出丰富的想法？", category: "创造天赋" },
            { id: 14, text: "我擅长空间想象和思考？", category: "空间天赋" },
            { id: 15, text: "我能找到不同寻常的问题解决办法？", category: "创造天赋" },
            { id: 16, text: "我喜欢有逻辑地思考问题？", category: "逻辑-算术天赋" },
            { id: 17, text: "我擅长理解数学问题？", category: "逻辑-算术天赋" },
            { id: 18, text: "我擅长用我的语言说服对方？", category: "语言天赋" },
            { id: 19, text: "我能识别和理解我的情绪？", category: "内省天赋" },
            { id: 20, text: "我擅长用数学方式进行论述？", category: "逻辑-算术天赋" },
            { id: 21, text: "我能从不同视角想象物体？", category: "空间天赋" },
            { id: 22, text: "我擅长用语言来表达想法？", category: "语言天赋" },
            { id: 23, text: "我能认识到我的愿望和需求，并与人交流？", category: "内省天赋" },
            { id: 24, text: "我乐于替别人着想？", category: "人际天赋" },
            { id: 25, text: "我拥有破框思维？", category: "创造天赋" },
            { id: 26, text: "我擅长空间定位？", category: "空间天赋" },
            { id: 27, text: "我能在遇到压力时让自己平静？", category: "内省天赋" },
            { id: 28, text: "我能根据说明将事物在脑海中呈现出来？", category: "空间天赋" },
            { id: 29, text: "我乐于与别人打交道？", category: "人际天赋" },
            { id: 30, text: "我乐于与不熟悉的动物共处？", category: "自然天赋" },
            { id: 31, text: "我能听到旋律中细微的不和谐之处？", category: "音乐天赋" },
            { id: 32, text: "我乐于照料不同种类的植物？", category: "自然天赋" },
            { id: 33, text: "我喜欢唱歌？", category: "音乐天赋" },
            { id: 34, text: "我能在时间紧迫的情况下处理问题？", category: "内省天赋" },
            { id: 35, text: "我能识别不同草药并在工作中使用它们？", category: "自然天赋" },
            { id: 36, text: "我喜欢原创性思考？", category: "创造天赋" },
            { id: 37, text: "我擅长装饰空间？", category: "美学天赋" },
            { id: 38, text: "我能迅速理解对方想要给我传达什么信息？", category: "语言天赋" },
            { id: 39, text: "我乐于学习不同种类的乐器？", category: "音乐天赋" },
            { id: 40, text: "我擅长在人与人之间斡旋？", category: "人际天赋" }
        ];
        
        // 选项配置
        const options = [
            { text: "非常符合", value: 5 },
            { text: "很符合", value: 4 },
            { text: "部分符合", value: 3 },
            { text: "不太符合", value: 2 },
            { text: "完全不符合", value: 1 }
        ];

        // 结果类型描述
        const resultDescriptions_high = {
            "语言天赋": "语言天赋高，善于迅速理解他人意图并精准表达自己，能通过语言引导对话。擅长组织语言，清晰阐述观点，沟通能力强。",
            "逻辑-算术天赋": "逻辑与算术天赋强，能轻松理解数学问题并应用公式。乐于使用数字和逻辑论证，逻辑思维和分析能力突出。",
            "空间天赋": "空间天赋出色，具备优秀的空间定位和想象能力。能轻松从多角度想象物体，在脑海中构建和加工空间关系。",
            "内省天赋": "内省天赋高，能快速识别和理解自我情绪。善于在压力下保持冷静，清楚个人边界并妥善处理自身感受。",
            "人际天赋": "人际天赋优秀，善于人际斡旋和换位思考。能够共情理解他人，并有效传授知识，沟通协调能力强。",
            "身体-动觉天赋": "动觉天赋出色，手指灵巧、动作流畅协调。善于完成手眼协调任务，能灵活运用身体达成目标。",
            "音乐天赋": "音乐天赋卓越，能轻松学习乐器并识别旋律细节。节奏感强，擅长唱歌演奏，具备音乐思考和表达能力。",
            "自然天赋": "自然天赋高，善于与动物相处并判断其需求。懂得照顾各类植物，对自然环境有敏锐感知和亲和力。",
            "创造天赋": "创造天赋突出，思维活跃且富有原创性。擅长创新思考和提出独特解决方案，常产生令人印象深刻的作品。",
            "美学天赋": "美学天赋优秀，善于用艺术方法处理和塑造事物。擅长色彩搭配和空间装饰，能创造和谐美观的环境。"
        };

        const resultDescriptions_low = {
            
        };

        // 天赋类型颜色配置
        const talentColors = {
            "语言天赋": "#4a6fa5",
            "逻辑-算术天赋": "#ff7e5f",
            "空间天赋": "#8bc34a",
            "内省天赋": "#9c27b0",
            "人际天赋": "#2196f3",
            "身体-动觉天赋": "#ff9800",
            "音乐天赋": "#e91e63",
            "自然天赋": "#4caf50",
            "创造天赋": "#3f51b5",
            "美学天赋": "#00bcd4"
        };
        
        // 天赋类型标签映射
        const talentLabels = {
            "语言天赋": "A. 语言",
            "逻辑-算术天赋": "B. 逻辑-算术",
            "空间天赋": "C. 空间",
            "内省天赋": "D. 内省",
            "人际天赋": "E. 人际",
            "身体-动觉天赋": "F. 身体-动觉",
            "音乐天赋": "G. 音乐",
            "自然天赋": "H. 自然",
            "创造天赋": "I. 创造",
            "美学天赋": "J. 美学"
        };
        
        // 应用状态
        const appState = {
            currentQuestionIndex: 0,
            answers: new Array(questions.length).fill(null), // 存储每题的答案值
            selectedOptionIndex: null, // 当前题目选中的选项索引
            totalQuestions: questions.length
        };
        
        // DOM元素
        const questionContainer = document.getElementById('questionContainer');
        const resultContainer = document.getElementById('resultContainer');
        const questionText = document.getElementById('questionText');
        const questionNumber = document.getElementById('questionNumber');
        const currentQuestion = document.getElementById('currentQuestion');
        const totalQuestions = document.getElementById('totalQuestions');
        const optionsContainer = document.getElementById('optionsContainer');
        const progressFill = document.getElementById('progressFill');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const resultScore = document.getElementById('resultScore');
        const resultDescription = document.getElementById('resultDescription');
        const restartBtn = document.getElementById('restartBtn');
        const radarLabels = document.getElementById('radarLabels');
        const scoresTable = document.getElementById('scoresTable');
        
        // 初始化应用
        function initApp() {
            // 设置总题数
            totalQuestions.textContent = `共 ${appState.totalQuestions} 题`;
            
            // 加载保存的进度
            loadProgress();
            
            // 显示第一题
            renderQuestion();
            
            // 绑定事件
            bindEvents();
        }
        
        // 渲染当前题目
        function renderQuestion() {
            const currentIndex = appState.currentQuestionIndex;
            const question = questions[currentIndex];
            
            // 更新题目文本
            questionText.textContent = question.text;
            questionNumber.textContent = `问题 ${currentIndex + 1}/${appState.totalQuestions}`;
            currentQuestion.textContent = `第 ${currentIndex + 1} 题`;
            
            // 更新进度条
            const progress = ((currentIndex + 1) / appState.totalQuestions) * 100;
            progressFill.style.width = `${progress}%`;
            
            // 清空选项容器
            optionsContainer.innerHTML = '';
            
            // 获取当前题目的答案
            const currentAnswer = appState.answers[currentIndex];
            
            // 创建选项按钮
            options.forEach((option, index) => {
                const optionBtn = document.createElement('button');
                optionBtn.className = 'option-btn';
                if (currentAnswer === option.value) {
                    optionBtn.classList.add('selected');
                    appState.selectedOptionIndex = index;
                }
                
                optionBtn.innerHTML = `
                    <span class="option-label">${String.fromCharCode(65 + index)}</span>
                    <span class="option-text">${option.text}</span>
                `;
                
                optionBtn.dataset.value = option.value;
                optionBtn.dataset.index = index;
                
                optionsContainer.appendChild(optionBtn);
            });
            
            // 更新导航按钮状态
            updateNavigationButtons();
        }
        
        // 更新导航按钮状态
        function updateNavigationButtons() {
            const currentIndex = appState.currentQuestionIndex;
            
            // 上一题按钮
            prevBtn.disabled = currentIndex === 0;
            
            // 下一题按钮
            const hasAnswer = appState.answers[currentIndex] !== null;
            if (currentIndex === appState.totalQuestions - 1) {
                nextBtn.textContent = '查看结果';
                nextBtn.disabled = !hasAnswer;
            } else {
                nextBtn.textContent = '下一题';
                nextBtn.disabled = !hasAnswer;
            }
        }
        
        // 选择答案并自动进入下一题
        function selectAnswer(optionIndex, value) {
            const currentIndex = appState.currentQuestionIndex;
            
            // 保存答案
            appState.answers[currentIndex] = value;
            appState.selectedOptionIndex = optionIndex;
            
            // 更新UI
            const optionBtns = document.querySelectorAll('.option-btn');
            optionBtns.forEach(btn => btn.classList.remove('selected'));
            optionBtns[optionIndex].classList.add('selected');
            
            // 更新导航按钮
            updateNavigationButtons();
            
            // 保存进度
            saveProgress();
            
            // 自动进入下一题（如果不是最后一题）
            setTimeout(() => {
                if (currentIndex < appState.totalQuestions - 1) {
                    nextQuestion();
                }
            }, 300); // 延迟300ms让用户看到选中效果
        }
        
        // 转到下一题
        function nextQuestion() {
            const currentIndex = appState.currentQuestionIndex;
            
            // 如果是最后一题，显示结果
            if (currentIndex === appState.totalQuestions - 1) {
                showResults();
                return;
            }
            
            // 否则转到下一题
            appState.currentQuestionIndex++;
            appState.selectedOptionIndex = null;
            renderQuestion();
        }
        
        // 转到上一题
        function prevQuestion() {
            if (appState.currentQuestionIndex > 0) {
                appState.currentQuestionIndex--;
                appState.selectedOptionIndex = appState.answers[appState.currentQuestionIndex] !== null ? 
                    options.findIndex(opt => opt.value === appState.answers[appState.currentQuestionIndex]) : null;
                renderQuestion();
            }
        }
        
        // 绘制雷达图
        function drawRadarChart(scores) {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 40;
            const talentTypes = Object.keys(scores).sort((a, b) => {
                // 按标签字母顺序排序
                const labelA = talentLabels[a] || a;
                const labelB = talentLabels[b] || b;
                return labelA.localeCompare(labelB);
            });
            const numAxes = talentTypes.length;
            const angleStep = (2 * Math.PI) / numAxes;
            
            // 清空画布
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 绘制网格
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            // 绘制5个同心圆
            for (let i = 1; i <= 5; i++) {
                ctx.beginPath();
                const gridRadius = (radius / 5) * i;
                
                for (let j = 0; j <= numAxes; j++) {
                    const angle = j * angleStep - Math.PI / 2;
                    const x = centerX + gridRadius * Math.cos(angle);
                    const y = centerY + gridRadius * Math.sin(angle);
                    
                    if (j === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.stroke();
            }
            
            // 绘制轴线
            ctx.strokeStyle = '#cccccc';
            ctx.lineWidth = 1;
            
            talentTypes.forEach((type, i) => {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // 绘制标签
                ctx.fillStyle = '#333';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // 调整标签位置，避免重叠
                const labelX = centerX + (radius + 30) * Math.cos(angle);
                const labelY = centerY + (radius + 30) * Math.sin(angle);
                
                // 简化标签文字
                const shortLabel = type.replace('天赋', '').replace('逻辑-算术', '逻辑');
                ctx.fillText(shortLabel, labelX, labelY);
            });
            
            // 绘制数据多边形
            ctx.beginPath();
            talentTypes.forEach((type, i) => {
                const score = scores[type];
                const maxPossibleScore = 10; // 每个天赋的最大可能得分
                const normalizedScore = (score / maxPossibleScore) * radius;
                
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + normalizedScore * Math.cos(angle);
                const y = centerY + normalizedScore * Math.sin(angle);
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            
            // 填充多边形
            ctx.fillStyle = 'rgba(74, 111, 165, 0.3)';
            ctx.fill();
            
            // 绘制多边形边框
            ctx.strokeStyle = '#4a6fa5';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // 绘制数据点
            talentTypes.forEach((type, i) => {
                const score = scores[type];
                const maxPossibleScore = 10;
                const normalizedScore = (score / maxPossibleScore) * radius;
                
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + normalizedScore * Math.cos(angle);
                const y = centerY + normalizedScore * Math.sin(angle);
                
                // 绘制数据点
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fillStyle = '#4a6fa5';
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // 在数据点旁边显示分数
                ctx.fillStyle = '#ff7e5f';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(score, x, y - 15);
            });
        }
        
        // 生成天赋分值表格
        function generateScoresTable(scores) {
            // 清空表格内容
            scoresTable.innerHTML = '<h3>各项天赋分值</h3>';
            
            // 按标签字母顺序排序天赋类型
            const sortedTypes = Object.keys(scores).sort((a, b) => {
                const labelA = talentLabels[a] || a;
                const labelB = talentLabels[b] || b;
                return labelA.localeCompare(labelB);
            });
            
            // 为每个天赋类型创建行
            sortedTypes.forEach(type => {
                const score = scores[type];
                const label = talentLabels[type] || type;
                const color = talentColors[type] || '#4a6fa5';
                
                // 确定分数等级
                let levelClass, levelText;
                if (score >= 12) {
                    levelClass = 'level-high';
                    levelText = '非常擅长';
                } else if (score >= 8) {
                    levelClass = 'level-medium';
                    levelText = '有些擅长';
                } else if (score >= 5) {
                    levelClass = 'level-low';
                    levelText = '不太擅长';
                } else {
                    levelClass = 'level-low';
                    levelText = '完全不擅长';
                }
                
                // 创建行元素
                const scoreRow = document.createElement('div');
                scoreRow.className = 'score-category';
                scoreRow.innerHTML = `
                    <div class="category-info">
                        <span class="category-label">${label.split('.')[0]}.</span>
                        <span class="category-name">${label.split('. ')[1] || label}</span>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <span class="score-value">${score}分</span>
                        <span class="score-level ${levelClass}">${levelText}</span>
                    </div>
                `;
                
                scoresTable.appendChild(scoreRow);
            });
        }
        
        // 生成雷达图标签
        function generateRadarLabels(scores) {
            radarLabels.innerHTML = '';
            
            // 按标签字母顺序排序
            const sortedTypes = Object.keys(scores).sort((a, b) => {
                const labelA = talentLabels[a] || a;
                const labelB = talentLabels[b] || b;
                return labelA.localeCompare(labelB);
            });
            
            sortedTypes.forEach(type => {
                const score = scores[type];
                const color = talentColors[type] || '#4a6fa5';
                const label = talentLabels[type] || type;
                
                // 创建标签
                const labelElement = document.createElement('div');
                labelElement.className = 'radar-label';
                labelElement.innerHTML = `
                    <span class="radar-color" style="background-color: ${color}"></span>
                    ${label.split('. ')[1] || label}: ${score}分
                `;
                radarLabels.appendChild(labelElement);
            });
        }
        
        // 显示结果
        function showResults() {
            // 计算各类型得分
            const typeScores = {};
            questions.forEach((question, index) => {
                const type = question.category;
                const answerValue = appState.answers[index] || 0;
                typeScores[type] = (typeScores[type] || 0) + answerValue;
            });
            
            // 确保所有天赋类型都有分数（即使为0）
            Object.keys(talentLabels).forEach(type => {
                if (!typeScores[type]) {
                    typeScores[type] = 0;
                }
            });
            
            // 计算总分
            const totalScore = Object.values(typeScores).reduce((sum, score) => sum + score, 0);
            const maxScore = appState.totalQuestions * 5;
            const percentage = Math.round((totalScore / maxScore) * 100);
            
            // 找出最高分的类型
            let dominantType = '';
            let highestScore = 0;
            for (const [type, score] of Object.entries(typeScores)) {
                if (score > highestScore) {
                    highestScore = score;
                    dominantType = type;
                }
            }
            
            // 显示结果
            resultScore.textContent = `${totalScore} 分 (${percentage}%)`;
            resultDescription.textContent = resultDescriptions_high[dominantType] || 
                "根据你的选择，你是一个多维度发展的人才，在不同领域都有所涉猎。";
            
            // 绘制雷达图
            drawRadarChart(typeScores);
            
            // 生成天赋分值表格
            generateScoresTable(typeScores);
            
            // 生成雷达图标签
            generateRadarLabels(typeScores);
            
            // 切换显示结果页面
            questionContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            
            // 清除保存的进度
            localStorage.removeItem('quizProgress');
        }
        
        // 重新开始测试
        function restartTest() {
            // 重置状态
            appState.currentQuestionIndex = 0;
            appState.answers = new Array(questions.length).fill(null);
            appState.selectedOptionIndex = null;
            
            // 切换回题目页面
            resultContainer.classList.add('hidden');
            questionContainer.classList.remove('hidden');
            
            // 重新渲染第一题
            renderQuestion();
        }
        
        // 保存进度到本地存储
        function saveProgress() {
            const progress = {
                currentQuestionIndex: appState.currentQuestionIndex,
                answers: appState.answers
            };
            localStorage.setItem('quizProgress', JSON.stringify(progress));
        }
        
        // 从本地存储加载进度
        function loadProgress() {
            const savedProgress = localStorage.getItem('quizProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                appState.currentQuestionIndex = progress.currentQuestionIndex;
                appState.answers = progress.answers;
                
                // 询问是否继续上次测试
                const hasAnswers = appState.answers.some(answer => answer !== null);
                if (hasAnswers) {
                    const continueTest = confirm("检测到未完成的测试，是否继续？");
                    if (!continueTest) {
                        // 重置进度
                        appState.currentQuestionIndex = 0;
                        appState.answers = new Array(questions.length).fill(null);
                    }
                }
            }
        }
        
        // 绑定事件
        function bindEvents() {
            // 选项点击事件 - 自动进入下一题
            optionsContainer.addEventListener('click', (e) => {
                const optionBtn = e.target.closest('.option-btn');
                if (optionBtn && !optionBtn.classList.contains('selected')) {
                    const value = parseInt(optionBtn.dataset.value);
                    const index = parseInt(optionBtn.dataset.index);
                    selectAnswer(index, value);
                }
            });
            
            // 下一题按钮
            nextBtn.addEventListener('click', nextQuestion);
            
            // 上一题按钮
            prevBtn.addEventListener('click', prevQuestion);
            
            // 重新开始按钮
            restartBtn.addEventListener('click', restartTest);
            
            // 键盘快捷键
            document.addEventListener('keydown', (e) => {
                // 数字键1-5选择选项
                if (e.key >= '1' && e.key <= '5') {
                    const index = parseInt(e.key) - 1;
                    if (index < options.length) {
                        selectAnswer(index, options[index].value);
                    }
                }
                
                // 左右箭头切换题目
                if (e.key === 'ArrowRight') {
                    if (!nextBtn.disabled) nextQuestion();
                }
                
                if (e.key === 'ArrowLeft') {
                    if (!prevBtn.disabled) prevQuestion();
                }
                
                // Enter键下一题
                if (e.key === 'Enter' && !nextBtn.disabled) {
                    nextQuestion();
                }
            });
        }
        
        // 初始化应用
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>